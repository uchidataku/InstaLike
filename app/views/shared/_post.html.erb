<div class="picture-post-box">
  <header>
    <div class="post-box-header">
      <%= link_to gravatar_for(@post.user, size: 30) %>
      <%= link_to @post.user.user_name, @post.user %>
    </div>
  </header>
  <div class="picture-box">
    <h3><%= image_tag @post.picture %></h3>
  </div>
  <div class="favorite-box">
    <% if current_user.liking?(@post) %>
      <%= form_for(current_user.favorites.find_by(post_id: @post.id), html: { method: :delete }) do |f| %>
        <%= hidden_field_tag :post_id, @post.id %>
        <%= f.submit "いいね!済み", class: "btn-xs btn-warning rounded-pill" %>
      <% end %>
    <% else %>
      <%= form_for(current_user.favorites.build) do |f| %>
        <%= hidden_field_tag :post_id, @post.id %>
        <%= f.submit "いいね!", class: "btn-xs btn-info rounded-pill" %>
      <% end %>
    <% end %>
  </div>
  <div class="content-box">
    <h4><strong><%= @post.user.user_name %></strong>
    <%= @post.content %></h4>
  </div>
  <div class="comment-box">
    <% @comments.each do |comment| %>
      <div>
        <strong><%= comment.user.user_name %></strong>
        <%= comment.text %>
        <a><%= link_to "削除する", post_comment_path(post_id: @post.id, id: comment.id), 
                                   method: :delete if current_user == comment.user %></a>
      </div>
    <% end %>
  </div>
  <div class="timestamp-box">
    <h5><%= time_ago_in_words(@post.created_at) %>前</h5>
  </div>
  <div class="comment-form-box">
    <%= form_tag("/posts/#{@post.id}/comments", method: :post) do %>
      <textarea name="text" placeholder="コメントを追加..."></textarea>
      <input type="submit" value="コメントする", class="btn-xs">
    <% end %>
  </div>
  <% if @post.user == current_user %>
    <div class="delete-box">
      <h5><%= link_to "削除する", post_path(@post), method: :delete, data: { confirm: "削除しますか？" } %></h5>
    </div>
  <% end %>
</div>